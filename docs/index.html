<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta charset="utf-8" />
  <title>Republishing Open Street Map’s roads as Linked Routable Tiles</title>
  <link rel="stylesheet" media="screen" href="styles/screen.css" />
  <link rel="stylesheet" media="print"  href="styles/print.css" />
  <style>
    .printonly {
    display: none;
    }
    @media print {
      .noprint {
        display: none;
      }
    .printonly {
      display: block;
    }
    }  
  </style>
  
</head>
<body prefix="rdf: http://www.w3.org/1999/02/22-rdf-syntax-ns# rdfs: http://www.w3.org/2000/01/rdf-schema# owl: http://www.w3.org/2002/07/owl# xsd: http://www.w3.org/2001/XMLSchema# dcterms: http://purl.org/dc/terms/ dctypes: http://purl.org/dc/dcmitype/ foaf: http://xmlns.com/foaf/0.1/ v: http://www.w3.org/2006/vcard/ns# pimspace: http://www.w3.org/ns/pim/space# cc: https://creativecommons.org/ns# skos: http://www.w3.org/2004/02/skos/core# prov: http://www.w3.org/ns/prov# qb: http://purl.org/linked-data/cube# schema: http://schema.org/ void: http://rdfs.org/ns/void# rsa: http://www.w3.org/ns/auth/rsa# cert: http://www.w3.org/ns/auth/cert# cal: http://www.w3.org/2002/12/cal/ical# wgs: http://www.w3.org/2003/01/geo/wgs84_pos# org: http://www.w3.org/ns/org# biblio: http://purl.org/net/biblio# bibo: http://purl.org/ontology/bibo/ book: http://purl.org/NET/book/vocab# ov: http://open.vocab.org/terms/ sioc: http://rdfs.org/sioc/ns# doap: http://usefulinc.com/ns/doap# dbr: http://dbpedia.org/resource/ dbp: http://dbpedia.org/property/ sio: http://semanticscience.org/resource/ opmw: http://www.opmw.org/ontology/ deo: http://purl.org/spar/deo/ doco: http://purl.org/spar/doco/ cito: http://purl.org/spar/cito/ fabio: http://purl.org/spar/fabio/ oa: http://www.w3.org/ns/oa# as: https://www.w3.org/ns/activitystreams# ldp: http://www.w3.org/ns/ldp# solid: http://www.w3.org/ns/solid/terms# acl: http://www.w3.org/ns/auth/acl# dio: https://w3id.org/dio# as: https://www.w3.org/ns/activitystreams# oa: http://www.w3.org/ns/oa# ldp: http://www.w3.org/ns/ldp#" typeof="schema:CreativeWork sioc:Post prov:Entity">
  <header>
  <h1 id="republishing-open-street-maps-roads-as-linked-routable-tiles">Republishing Open Street Map’s roads as Linked Routable Tiles</h1>

  <ul id="authors">
    <li><a href="https://pietercolpaert.be" typeof="http://xmlns.com/foaf/0.1/Person" resource="https://pietercolpaert.be/#me">Pieter Colpaert</a></li>
    <li><a href="https://wiki.openstreetmap.org/wiki/User:Ben.abelshausen" typeof="http://xmlns.com/foaf/0.1/Person" resource="https://wiki.openstreetmap.org/wiki/User:Ben.abelshausen">Ben Abelshausen</a></li>
    <li><a href="#julian" typeof="http://xmlns.com/foaf/0.1/Person" resource="#julian">Julián Andrés Rojas Meléndez</a></li>
    <li><a href="#harm" typeof="http://xmlns.com/foaf/0.1/Person" resource="#harm">Harm Delva</a></li>
    <li><a href="https://ruben.verborgh.org/" typeof="http://xmlns.com/foaf/0.1/Person" resource="https://ruben.verborgh.org/profile/#me">Ruben Verborgh</a></li>
  </ul>

  <ul id="affiliations">
    <li id="idlab">IDLab,
          Department of Electronics and Information Systems,
          Ghent University – imec</li>
  </ul>

  <section class="context">
    <h2 id="in-reply-to">In reply to</h2>
    <ul>
      <li><a href="https://2019.eswc-conferences.org/call-for-posters-and-demos/" rel="as:inReplyTo">Call For Posters and Demos ESWC 2019</a></li>
    </ul>
  </section>

</header>

<!-- Hack to make our custom fonts load in print-mode -->
<!-- https://stackoverflow.com/questions/39364259/chrome-print-preview-doesnt-load-media-only-print-font-face -->
<p><span class="printfont1"> </span>
<span class="printfont2"> </span>
<span class="printfont3"> </span>
<span class="printfont4"> </span></p>

<div class="double-column">

<section id="abstract">
    <h2>Abstract</h2>
    <!-- Context      -->
    <p>Route planning providers manually integrate different geo-spatial datasets 
before offering a Web service to developers, thus creating a closed world view. 
In contrast, combining open datasets at runtime 
can provide more information for user-specific route planning needs. 
For example, an extra dataset of bike sharing availabilities 
may provide more relevant information to the occasional cyclist.
<!-- Need         -->
A strategy for automating the adoption of open geo-spatial datasets is needed 
to allow an ecosystem of route planners able to answer more specific and complex queries. 
This rises new challenges such us 
(i) how open geo-spatial datasets should be published on the Web to raise interoperability, 
and (ii) how route planners can discover and integrate relevant data for a certain query on the fly.
<!-- Task         --> 
We republished Open Street Map’s road network as “Routable Tiles”
to facilitate its integration into open route planners.
To achieve this, we use a Linked Data strategy and follow an approach similar to vector tiles.
<!-- Object       -->
In a demo, we show how client-side code can automatically discover tiles and perform a shortest path algorithm.
<!-- Findings     -->
We provide four contributions: (i) we launched an open geo-spatial dataset that is available for everyone to reuse at no cost, (ii) we published a Linked Data version of the Open Street Map ontology, (iii) we introduced a hypermedia specification for vector tiles that extends the Hydra ontology, and (iv) we released the mapping scripts, demo and routing scripts as open source software.
<!-- Conclusion and Perspectives -->
<!-- The preliminary conclusions of this work put forward more questions than answers: 
are existing RDF serializations compact enough for an acceptable user experience? 
What happens when another dataset needs to introduce new nodes that are not in the base map? 
Can other hypermedia structures be thought of?--></p>

  </section>


<main>
  <!-- Add sections by specifying their file name, excluding the '.md' suffix. -->
  <section>
      <div class="printonly">Read the HTML-version: <a href="https://pieter.pm/demo-paper-routable-tiles/">http:/​/​pieter.pm/demo-paper-routable-tiles/</a></div>

      <h2 id="introduction">Introduction</h2>

      <p>When setting up a Web-based journey planner that takes into account individual user needs, 
developers are confronted with the daunting prospect of integrating heterogeneous datasets. 
Industry players provide an alternative solution to these complexities, 
by providing services on top of their datasets that are centralized in one location. 
They are able to provide a solution for the ~80% of the world-wide needs 
and build a business around that. 
When trying to cater to the remaining 20%, 
industrial route planners are quickly confronted 
with diminishing returns of integrating more datasets.
Take for example use cases of (i) people owning a foldable bike and the ability to take their bike on public transport, 
(ii) companies trying to find an optimal delivery route for their delivery service where some vehicles cannot pass through low emission zones, 
(iii) routes based on the real-time state of traffic control systems and probability to hit a green light,
or (iv) people with special constraints or disabilities.
For each of these four use cases, 
extra datasets are needed to calculate these end-user specific routing graphs. 
Such datasets are published by different organizations
that often publish them openly, thanks to strategic goals or legal mandates. 
Every route planner will somehow need to compile their own sources 
over which they can execute their own route planning algorithm.</p>

      <p>In this paper, we aim to automate data adoption in route planners.
As a first step, we introduce <em>Routable Tiles</em>. 
This is a hypermedia specification for geospatial road networks.
In this specification, we republished all the roads in Open Street Map.
In the next section we will see that the ideas behind Routable Tiles itself is not novel.
The contribution of this paper lies in applying the geospatial indexing idea from the database world
to Web APIs, introducing an ontology for describing geospatial hypermedia controls,
and launching this world-wide dataset as a resource to the Semantic Web community.</p>

      <!--After introducing the ontology, specification and server software, 
we demonstrate what now becomes possible in an in-browser demo. 
The browser itself can perform a routing algorithm, 
and every step in the routing algorithm can thus involve other weights and datasets as it pleases.
Finally, we discuss the open challenges that arose publishing the data for client-side adoption in the conclusion and discussion section.-->

    </section>

  <section id="sota">
      <h2>Related work</h2>

      <h3 id="geospatial-data-on-the-web">Geospatial data on the Web</h3>

      <p><a property="schema:citation http://purl.org/spar/cito/cites" href="https://www.w3.org/TR/sdw-bp/">Spatial Data on the Web</a> <span class="references">[<a href="#ref-1">1</a>]</span> is a W3C and OGC collaboration 
to create a list of best practices for spatial data on the Web.
It takes a strong position in favor of HTTP URIs to identify resources.
The rationale is that Linked Data principles such as the use of HTTP URIs as global identifiers, 
raises the interoperability of geo-spatial datasets 
by providing a common set of semantics that can be reused by data publishers.</p>

      <p>Slippy maps are maps often included in web-pages on which you can pan around.
In order to reduce server load, the client is preconfigured with a URL template of the web-server containing image tiles.
E.g., <code>https:/​/​{s}.tile.openstreetmap.org/{z}/{x}/{y}.png</code>, where <code>s</code> denotes a subdomain to be used, <code>z</code> the zoom-level the slippy map is at, and <code>x</code> and <code>y</code> are the coordinates of the upper left corner of the tile.
When the map is loaded, the client can calculate all URLs necessary.
Vector tiles reuse this idea to, instead of raster images, publish the raw data behind the tiles.
The client can then render the maps on the client-side.
This gives clear benefits over raster images:
 (i) the styling of the maps can be done by UI developers that can use CSS and scripts to style the road elements,
 (ii) vector tiles can be smaller in size as vectors are typically much smaller than a rendered bitmap, and
 (iii) it allows for all elements on the map to become interactive.
Existing implementations include the Mapbox vector tiles and Open Map Tiles.
Each have their own specificities and schemas (see <a href="https://docs.mapbox.com/vector-tiles/mapbox-streets-v8/">https:/​/​docs.mapbox.com/vector-tiles/mapbox-streets-v8/</a> and <a href="https://openmaptiles.org/schema/">https:/​/​openmaptiles.org/schema/</a>) with a strong focus on rendering maps.</p>

      <p><a href="https://github.com/valhalla/valhalla">Valhalla by Mapzen and now hosted by the Linux Foundation</a> is the first project that implements the idea of vector tiles for route planners in an open-source project.
The technology proposes a <a href="https://github.com/valhalla/valhalla/blob/master/docs/tiles.md">tiling specification</a> for storing routing information on disk.
Tiling the data makes sure the server can be selective about the data that needs to be loaded into memory in order to execute an individual request.
This tiling specification in Valhalla is however not used as an exchange format – although offline routing is an upcoming feature – and interoperability with other datasets is not a focus.</p>

      <p><a property="schema:citation http://purl.org/spar/cito/cites" href="http://jens-lehmann.org/files/2012/linkedgeodata2.pdf">Linked Geo Data</a> <span class="references">[<a href="#ref-2">2</a>]</span> is an initiative that maps Open Street Map data to Linked Data.
It releases data dumps, subject pages and a SPARQL endpoint.
Furthermore, it has their own mappings from the Open Street Map data model to a Linked Geo Data ontology.</p>

      <h3 id="open-data-publishing">Open Data publishing</h3>

      <p>Open Data can be published in various interfaces.
In order to be able to query these interfaces, <span property="schema:citation http://purl.org/spar/cito/cites" resource="https://dx.doi.org/10.1007/978-3-030-00668-6_15"><a href="https://comunica.github.io/Article-ISWC2018-Resource/">Comunica</a></span> <span class="references">[<a href="#ref-3">3</a>]</span> was built.
It is a Linked Data user agent that can run federated queries over several heterogeneous Web APIs, such as data dumps, SPARQL endpoints, Linked Data documents and <span property="schema:citation http://purl.org/spar/cito/cites" resource="https://dx.doi.org/10.1016/j.websem.2016.03.003"><a href="http://linkeddatafragments.org/publications/jws2016.pdf">Triple Pattern Fragments</a></span> <span class="references">[<a href="#ref-4">4</a>]</span>.
This engine has been developed to make it easy to plug in specific types of functionality as separate modules. Such modules can be added or removed depending on the configuration. As such, by looking for affordances in Web APIs, more intelligent user agents can be created.
Preconditions for an engine like Comunica to work with a dataset is: supporting a Linked Data representation and allowing cross origin resource sharing headers in the HTTP responses.
The better the data is split in fragments, the better the caching will be able to provide a faster user-perceived performance.</p>

      <p>For public transport systems, instead of publishing a dump of time schedules or a full fletched route planner, <a property="schema:citation http://purl.org/spar/cito/cites" href="http://ceur-ws.org/Vol-1486/paper_28.pdf">Linked Connections</a> <span class="references">[<a href="#ref-5">5</a>]</span> proposes a publishing mechanism that gives clients access to the data in time fragments.
It uses departure-arrival pairs from a station to another (a connection), and orders these connections by departure time.
It then fragments this dataset in documents that can be published over HTTP.
Links in the responses ensure a client can always find more information to take into account.</p>

    </section>

  <section id="implementation">
      <h2>Implementation</h2>

      <p>Routable Tiles is a JSON-LD specification for which the working draft can be found at <a href="https://openplanner.team/specs/2018-11-routable-tiles.html">https:/​/​openplanner.team/specs/2018-11-routable-tiles.html</a>.
It has three main aspects: (i) it introduces a <em>hypermedia specification</em> reusing Hydra Collections for describing a tile server, (ii) a way to describe <em>Open Street Map’s nodes, ways and relations</em>; and (iii) it introduces a mapping of the Open Street Map basic terms to an RDFS vocabulary.</p>

      <p>The Linked Geo Data vocabulary has been unavailable since 2018 and not updated since 2015.
Therefore we introduced our own vocabulary, that nonetheless takes a different approach.
Instead of mapping everything, we decided to map only the bare minimum needed specifically for the use case or route planing.
Therefore, we keep the ontology as close as possible to the actual OSM data model.
We added links to the appropriate Linked Geo Data classes (ontology has yet to be published, awaiting a third party implementation).</p>

      <p>We define 3 main classes: <em>osm:Way</em>, <em>osm:Relation</em> and <em>osm:Node</em>.
The <em>osm:members</em> property describes the members of the relation and the <em>osm:role</em> their function in the relation.
<em>osm:restriction</em> is used to model turn restrictions.
The property <em>osm:nodes</em> is used to link to an <em>rdf:List</em> of <em>osm:Node</em> items.
In one page, multiple lists can be described.
If a Way crosses a tile, the other tile also mentioned the border Node in one of its rdf:Lists.
The property <em>osm:members</em> is used to link to an <em>rdf:List</em> of <em>osm:Member</em> items.</p>

      <p>The mapping scripts and server interface can be found at <a href="https://github.com/openplannerteam/routeable-tiles">https:/​/​github.com/openplannerteam/routeable-tiles</a>.
Every tile in Open Street Map on zoom level 14 is on the fly made available as JSON-LD.
Special attention was given to the HTTP server to include a server-side cache and to compress the HTTP response with gzip.
Furthermore, it sets both an etag header and a cache-control max-age header for client-side cache control.
Finally, it also allows webpages on other domains to request its data by setting the appropriate Cross Origin Resource Sharing headers.</p>

      <!--Due to [a recent change in the WhatWG fetch specification](https://github.com/whatwg/fetch/issues/862), there is also a need for supporting the OPTIONS method, that specifically allows all headers in its response.-->

      <p>For the URIs of Ways and Nodes, we decided to reuse the subject pages provided by the Open Street Map project itself.
We hope that at some point, Open Street Map decides to support a Linked Data representation on these URIs.
For example: <a href="https://www.openstreetmap.org/node/366934331">openstreetmap.org/node/366934331</a> and <a href="https://www.openstreetmap.org/way/242536619">openstreetmap.org/way/242536619</a>.</p>

    </section>

  <section id="demonstrator">
      <h2>Demonstrator</h2>

      <p>A server instance is set up publishing data for <em>the entire world</em>.
Entry points into the hypermedia API can be found through <a href="https://tiles.openplanner.team/planet/14/8411/5485/">https:/​/​tiles.openplanner.team/planet/14/{x}/{y}/ (e.g., with x 8411 and y 5485</a>.
A live demonstrator using this data can be found at <a href="https://openplannerteam.github.io/leaflet-routable-tiles/">https:/​/​openplannerteam.github.io/leaflet-routable-tiles/</a>.</p>
      <div class="printonly">The demonstrator shows a map of all roads (in Portorož by default) in the viewport.
The map is drawn on the client-side based on the JSON-LD documents fragmented in tiles.
When clicking 2 locations on the map, the same JSON-LD documents are used to perform a Dijkstra shortest path algorithm.
</div>

      <figure id="listing2" class="noprint">
<!--<img src="img/routabletiles.png" class="printonly"/>-->
<iframe class="noprint" src="https://openplannerteam.github.io/leaflet-routable-tiles/#latitude=45.515570&amp;longitude=13.595109" style="width: 100%; height: 50vh;">
</iframe>
<figcaption><span class="label">Fig. 1:</span> A demonstrator of what you can do with Routable Tiles. You can pan around, select another city, and calculate a shortest path. Both rendering the map and the route planning happens on the client-side while loading the tiles dynamically.</figcaption>
</figure>

    </section>

  <section id="conclusion">
      <h2>Conclusion and discussion</h2>

      <p>In this paper, we introduced a specification for publishing Open Street Map’s roads as Linked Open Data 
following the ideas behind <span property="schema:citation http://purl.org/spar/cito/cites" resource="https://dx.doi.org/10.1016/j.websem.2016.03.003"><a href="http://linkeddatafragments.org/publications/jws2016.pdf">Linked Data Fragments</a></span> <span class="references">[<a href="#ref-4">4</a>]</span>.
We conclude with a list of benefits and open issues on this approach.</p>

      <p>Firstly, the server costs are lower as it does not have to answer any individual routing request.
Instead it sends the data itself to the client that needs to perform the algorithm itself.
The URLs that are requested are the same thanks to the hypermedia controls and HTTP caching can be leveraged.
Next to the fact that server-costs become limited, it also gives flexibility to developers using the data.
They do not have to contact the server-administrators of these open datasets for new features to add.
Just like vector tiles styling, they can tailor the routing algorithm to their end-user needs in the browser.</p>

      <p>This also gives the benefit that not one server has to contain all of the world’s data.
It opens the door to use cases where source selection also happens on the client and multiple sources are queried at once.
Also for use cases outside the routing domain, routable tiles becomes useful.
The hypermedia controls can be added as an <span property="schema:citation http://purl.org/spar/cito/cites" resource="https://dx.doi.org/10.1007/978-3-030-00668-6_15"><a href="https://comunica.github.io/Article-ISWC2018-Resource/">actor to Comunica (future work for now)</a></span> <span class="references">[<a href="#ref-3">3</a>]</span> 
and help it solve geo-spatial queries over any data source by downloading only the right tiles.</p>

      <p>A precondition in order to be queryable by Comunica, 
is that the data is available in an RDF serialization.
As we use JSON-LD with well thought-out context, 
this data can be serialized into usable RDF.
However, while the benefits of uniquely identifying Routable Tiles 
and publish them on the Web as Linked Data Fragments are clear, 
it still remains an open question if applying the Linked Data model 
to the roads related data is the optimal approach.
For example, when another source wants to do a statement 
about a part of a road that is not yet an osm:Way instance, 
how will this data be interoperable with this dataset? 
On the other hand, having a semantic vocabulary to describe 
not only roads but all the elements that belong to the OSM terminology 
opens the door for other data publishers to link their own data to the 
OSM data source increasing the interoperability of their datasets.</p>

      <p>In future work, we will benchmark the difference in size and performance 
between Valhalla tiles (protobuf) and Routable Tiles (JSON-LD + gzip).
Maybe there will be a need in the future for the Routable Tiles specification 
to support a binary format in order to reduce size. 
In  general, still several optimizations can be done, 
such as applying contraction hierarchies and exposing data on multiple zoom levels.</p>

    </section>

</main>

<footer>
<section id="references">
<h2>References</h2>
<dl class="references">
  <dt id="ref-1">[1]</dt>
  <dd resource="https://www.w3.org/TR/sdw-bp/" typeof="schema:CreativeWork">Tandy, J., Barnaghi, P., van den Brink, L.: Spatial Data on the Web Best Practices. W3C, <a href="https://www.w3.org/TR/sdw-bp/">https:/​/​www.w3.org/TR/sdw-bp/</a> (2017).</dd>
  <dt id="ref-2">[2]</dt>
  <dd resource="http://jens-lehmann.org/files/2012/linkedgeodata2.pdf" typeof="schema:Article">Stadler, C., Lehmann, J., Höffner, K., Auer, S.: LinkedGeoData: A Core for a Web of Spatial Open Data. Semantic Web Journal. 3, 333–354 (2012).</dd>
  <dt id="ref-3">[3]</dt>
  <dd resource="https://dx.doi.org/10.1007/978-3-030-00668-6_15" typeof="schema:Article">Taelman, R., Van Herwegen, J., Vander Sande, M., Verborgh, R.: Comunica: a Modular SPARQL Query Engine for the Web. In: Vrandečić, D., Bontcheva, K., Suárez-Figueroa, M.C., Presutti, V., Celino, I., Sabou, M., Kaffee, L.-A., and Simperl, E. (eds.) Proceedings of the 17th International Semantic Web Conference. pp. 239–255. Springer (2018).</dd>
  <dt id="ref-4">[4]</dt>
  <dd resource="https://dx.doi.org/10.1016/j.websem.2016.03.003" typeof="schema:Article">Verborgh, R., Vander Sande, M., Hartig, O., Van Herwegen, J., De Vocht, L., De Meester, B., Haesendonck, G., Colpaert, P.: Triple Pattern Fragments: a Low-cost Knowledge Graph Interface for the Web. Journal of Web Semantics. 37–38, (2016).</dd>
  <dt id="ref-5">[5]</dt>
  <dd resource="http://ceur-ws.org/Vol-1486/paper_28.pdf" typeof="schema:Article">Colpaert, P., Llaves, A., Verborgh, R., Corcho, O., Mannens, E., Van de Walle, R.: Intermodal public transit routing using Linked Connections. In: Proceedings of the 14th International Semantic Web Conference: Posters and Demos (2015).</dd>
</dl>
</section>
</footer>

</div>



</body>
</html>
